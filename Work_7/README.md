# 实验七 存储函数、触发器和事件

## 一、实验目的

1. 掌握存储函数的创建和使用方法
2. 掌握触发器的创建和使用方法
3. 掌握事件的创建和使用方法

## 二、实验内容

### 一、存储函数

#### 1. 创建简单存储函数
创建一个存储函数,输入员工编号,返回该员工的姓名

#### 2. 创建带计算的存储函数
创建一个存储函数,输入员工编号,返回该员工的实际收入(收入-支出)

#### 3. 创建带条件判断的存储函数
创建一个存储函数,输入员工编号,返回该员工的工资等级(高薪/中等/低薪)

#### 4. 创建统计存储函数
创建一个存储函数,输入部门编号,返回该部门的平均工资

---

### 二、触发器

#### 1. 创建 INSERT 触发器
创建一个触发器,当向 Employees 表插入新记录时,自动在 Salary 表中插入一条对应的工资记录(初始收入和支出均为 0)

#### 2. 创建 DELETE 触发器
创建一个触发器,当从 Employees 表删除员工记录时,自动删除 Salary 表中对应的工资记录

#### 3. 创建 UPDATE 触发器
创建一个触发器,当更新 Salary 表中的收入时,将旧收入和新收入记录到一个日志表中

#### 4. 创建 BEFORE 触发器
创建一个 BEFORE INSERT 触发器,在向 Employees 表插入记录前,检查部门编号是否存在于 Departments 表中

---

### 三、事件

#### 1. 创建一次性事件
创建一个事件,在指定时间执行一次,清空测试表中的数据

#### 2. 创建周期性事件
创建一个事件,每天执行一次,统计各部门的员工人数并记录到统计表中

#### 3. 创建带结束时间的周期性事件
创建一个事件,每小时执行一次,在指定日期后停止

